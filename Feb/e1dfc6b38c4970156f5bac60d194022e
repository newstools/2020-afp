Barcelona and Real Madrid both crashed out of the Copa del Rey on Thursday night as Athletic Bilbao and Real Sociedad pulled off a shock Basque double to reach the semi-finals. Barca were beaten 1-0 by Bilbao at San Mames, where Inaki Williams scored a dramatic 93rd-minute winner, after la Real had seen off Madrid 4-3 in a seven-goal thriller at the Santiago Bernabeu. Two sensational upsets added another layer of excitement to a competition that has been full of surprises this season, with Bilbao and Real Sociedad now joining Granada and second division Mirandes in an unfamiliar line-up for the draw on Friday. For Barca, defeat was particularly painful, coming at the end of a turbulent week that saw Lionel Messi engage in a public spat with the club's sporting director Eric Abidal and Ousmane Dembele ruled out, probably for the rest of the season, with another hamstring tear. To make matters worse, Gerard Pique hobbled off with his own injury problem in the second half against Bilbao and now looks doubtful to face Real Betis in La Liga on Sunday. Messi's riposte that "everyone should take responsibility for their own decisions" after Abidal suggested Ernesto Valverde was sacked last month because of the players, means Barcelona are in political turmoil off the pitch. And the fear is Messi could even leave in the summer by activating a clause in his contract that allows him to walk away from the club for free. Defeat in the Copa del Rey, a distance third in Barca's list of priorities this season, will not dictate Messi's thinking but another setback certainly adds to the sense of a club currently in a state of crisis. Quique Setien has now lost two of his opening six games in charge, with a Champions League tie against Napoli fast-approaching. The fall-out from another disappointment in Europe would prove longer-lasting. - 'It hurts' - For a rotated Madrid side, who sit top of La Liga, the loss against Real Sociedad was perhaps less damaging, even if they conceded as many goals in 69 minutes as they had in their last 11 matches. Martin Odegaard, on loan at la Real but allowed to face his parent club, scored the opener before the superb Alexander Isak hit two to give Real Sociedad a remarkable 3-0 lead. Marcelo and Rodrygo both scored late in the second half and while Mikel Merino added a fourth for the visitors, a Nacho Fernandez header set up a wild final three minutes, in which Andoni Gorosabel was also sent off. Ten-man Real Sociedad held on for a superb win to progress to the last four while Madrid's run without success in Spain's domestic cup extends to six years. "It hurts, we have to be honest, nobody likes a defeat," said Madrid coach Zinedine Zidane. One consolation might have been the display of the 21-year-old Odegaard, who is beginning to live up to the hype after signing for Madrid aged 15. On loan at Sociedad, the plan was for Odegaard to stay one more year at Anoeta but this glittering display, that earned him a standing ovation from the home fans when he went off, may well persuade Madrid to recall him early. Their 21-game unbeaten streak comes to an end after an uncharacteristically careless performance in which a rotated side highlighted the importance of the likes of Casemiro, Raphael Varane and Thibaut Courtois. Courtois' replacement Alphonse Areola was at fault for at least one of the goals while Marcelo was typically unpredictable at left-back, a position the more dependable Ferland Mendy has made his own in recent weeks. Eden Hazard is training again but the wait for his return goes on while Gareth Bale was again left out of the squad completely. Yet Zidane's changes should take nothing away from Real Sociedad, who showed why they were pushing for a place in La Liga's top four earlier this season, before a dip in form has seen them slip to eighth. "It is the second time in 32 years we've reached the semis," said their coach Imanol Alguacil. "We were convinced we could do it. But we haven't achieved anything yet."